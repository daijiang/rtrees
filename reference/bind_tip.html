<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Graft a tip to a phylogeny at location specified."><title>Bind a tip to a phylogeny — bind_tip • rtrees</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bind a tip to a phylogeny — bind_tip"><meta property="og:description" content="Graft a tip to a phylogeny at location specified."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rtrees</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Non-monophyletic-groups.html">Non-monophyletic genera</a>
    <a class="dropdown-item" href="../articles/Simple_example.html">Simple_example</a>
    <a class="dropdown-item" href="../articles/grafting_scenarios.html">Grafting Scenarios</a>
    <a class="dropdown-item" href="../articles/speed.html">Speed comparisons</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Bind a tip to a phylogeny</h1>
      
      <div class="d-none name"><code>bind_tip.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Graft a tip to a phylogeny at location specified.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bind_tip</span><span class="op">(</span></span>
<span>  tree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">where</span>,</span>
<span>  <span class="va">tip_label</span>,</span>
<span>  frac <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  new_node_above <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  node_label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_tree <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tree_tbl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  node_heights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_castor <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sequential <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tree</dt>
<dd><p>A phylogeny, with class of "phylo".</p></dd>


<dt>where</dt>
<dd><p>Location where to insert the tip. It can be either tip label or node label, but must be characters. If the location does not have a name, assign it first.</p></dd>


<dt>tip_label</dt>
<dd><p>Name of the new tip inserted.</p></dd>


<dt>frac</dt>
<dd><p>The fraction of branch length, must be between 0 and 1. This only applies when location is a tip or <code>new_node_above = TRUE</code>. The distance from the new inserted node to the location (a node or a tip) is the branch length of the location * (1 - frac).</p></dd>


<dt>new_node_above</dt>
<dd><p>Whether to insert the new node above when the location is a node? Default is <code>FALSE</code>, which will attach the new tip to the location node.</p></dd>


<dt>node_label</dt>
<dd><p>Name of the new node created. This only applies when location is a tip or <code>new_node_above = TRUE</code>.</p></dd>


<dt>return_tree</dt>
<dd><p>Whether to return a phylogeny with class "phylo?" Default is <code>TRUE</code>. Otherwise, it will return a data frame.</p></dd>


<dt>tree_tbl</dt>
<dd><p>A tibble version of the tree, optional.</p></dd>


<dt>node_heights</dt>
<dd><p>A named numeric vector of node hieghts of the tree, generated by <code><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">ape::branching.times()</a></code>. It is also optional if <code>tree</code> is specified; but required if <code>tree_tbl</code> is specified.</p></dd>


<dt>use_castor</dt>
<dd><p>Whether to use package <code>castor</code> to get the phylogeny at a node; it is faster than <code><a href="https://rdrr.io/pkg/tidytree/man/offspring.html" class="external-link">tidytree::offspring</a></code> to figure out what are the tip offsprings at a node.</p></dd>


<dt>sequential</dt>
<dd><p>Whether to add the tip with sequential node number in the edge matrix. For example, if we want to bind a tip to a clade and the node number of the tips of this clade is from 101 to 150. We can set the node id of the new tip to 151 and push all the remaining node id to 1 after their current values. This will require us to find out the node ids of all tips that are descents of the node where we want to bind the new tip to, and it can be time costly. Yet I am still not sure whether this is necessary. Normally, the node ids of the <code>phylo</code> class are sequential. Therefore, the default value here is <code>TRUE</code>. If set to <code>FALSE</code>, we can just assign the id of the new tip to Ntip + 1 to save time. In addition, we probably don't need to order the node column of the edge matrix every time.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Either a phylogeny or a data frame, which can be then converted to a phylogeny later.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://daijiang.github.io/rtrees/">rtrees</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">bind_tip</span><span class="op">(</span><span class="va">tree_plant_otl</span>, <span class="st">"N70407"</span>, tip_label <span class="op">=</span> <span class="st">"test_sp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree_plant_otl_df</span> <span class="op">=</span> <span class="fu">tidytree</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">tree_plant_otl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">node_heights</span> <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">tree_plant_otl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">bind_tip</span><span class="op">(</span>tree_tbl <span class="op">=</span> <span class="va">tree_plant_otl_df</span>, where <span class="op">=</span> <span class="st">"N70407"</span>, </span></span>
<span class="r-in"><span>         tip_label <span class="op">=</span> <span class="st">"test_sp"</span>, node_heights <span class="op">=</span> <span class="va">node_heights</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Daijiang Li.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

