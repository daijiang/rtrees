<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="For some taxa groups, there are multiple posterior megatrees. It is a common
task to derive a phylogeny from each of these (or a random subset of) megatrees."><title>Get one or multiple trees from megatree(s) — get_tree • rtrees</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get one or multiple trees from megatree(s) — get_tree"><meta property="og:description" content="For some taxa groups, there are multiple posterior megatrees. It is a common
task to derive a phylogeny from each of these (or a random subset of) megatrees."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rtrees</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Non-monophyletic-groups.html">Non-monophyletic genera</a>
    <a class="dropdown-item" href="../articles/Simple_example.html">Simple_example</a>
    <a class="dropdown-item" href="../articles/grafting_scenarios.html">Grafting Scenarios</a>
    <a class="dropdown-item" href="../articles/speed.html">Speed comparisons</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get one or multiple trees from megatree(s)</h1>
      
      <div class="d-none name"><code>get_tree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For some taxa groups, there are multiple posterior megatrees. It is a common
task to derive a phylogeny from each of these (or a random subset of) megatrees.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_tree</span><span class="op">(</span></span>
<span>  <span class="va">sp_list</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  taxon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"at_basal_node"</span>, <span class="st">"random_below_basal"</span><span class="op">)</span>,</span>
<span>  show_grafted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tree_by_user <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mc_cores <span class="op">=</span> <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>,</span>
<span>  .progress <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  fish_tree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timetree"</span>, <span class="st">"all-taxon"</span><span class="op">)</span>,</span>
<span>  mammal_tree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vertlife"</span>, <span class="st">"phylacine"</span><span class="op">)</span>,</span>
<span>  dt <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>sp_list</dt>
<dd><p>A character vector or a data frame with at least three columns: species, genus, family. Species column
holds the species for which we want to have a phylogeny. It can also have two optional columns:
close_sp and close_genus. We can specify the closest species/genus of the species based on
expert knowledge. If specified, the new species will be grafted to that particular location.</p>
<p>It can also be a string vector if <code>taxon</code> is specified. Though it probably is a better idea
to prepare your data frame with <code><a href="sp_list_df.html">sp_list_df()</a></code>. The string vector can also have the same format
as that required by Phylomatic (i.e., family/genus/genus_sp).</p></dd>


<dt>tree</dt>
<dd><p>A mega-tree with class <code>phylo</code> or a list of mega-trees with class <code>multiPhylo</code>.
Optional if <code>taxon</code> is specified, in which case, a default
mega-phylogeny (or a set of 100 randomly selected posterior phylogenies) will be used
(see their own documentations from the <code>megatrees</code> package).</p><ul><li><p>For amphibian, the mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_amphibian_n100.html" class="external-link">megatrees::tree_amphibian_n100</a>.</p></li>
<li><p>For bird, the mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_bird_n100.html" class="external-link">megatrees::tree_bird_n100</a>.</p></li>
<li><p>For fish, the mega-tree is <a href="https://rdrr.io/pkg/megatrees/man/tree_fish_12k.html" class="external-link">megatrees::tree_fish_12k</a>, with <a href="https://rdrr.io/pkg/megatrees/man/tree_fish_32k_n50.html" class="external-link">megatrees::tree_fish_32k_n50</a> be the other option.</p></li>
<li><p>For mammal, the default mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_mammal_n100_vertlife.html" class="external-link">megatrees::tree_mammal_n100_vertlife</a>, with <a href="https://rdrr.io/pkg/megatrees/man/tree_mammal_n100_phylacine.html" class="external-link">megatrees::tree_mammal_n100_phylacine</a> be the other option.</p></li>
<li><p>For plant, the mega-tree is <a href="https://rdrr.io/pkg/megatrees/man/tree_plant_otl.html" class="external-link">megatrees::tree_plant_otl</a>.</p></li>
<li><p>For reptile, the mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_reptile_n100.html" class="external-link">megatrees::tree_reptile_n100</a>.</p></li>
<li><p>For shark, ray, and chimaeras, the mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_shark_ray_n100.html" class="external-link">megatrees::tree_shark_ray_n100</a>.</p></li>
</ul></dd>


<dt>taxon</dt>
<dd><p>The taxon of species in the <code>sp_list</code>. Currently, can be <code>amphibian</code>, <code>bird</code>, <code>fish</code>, <code>mammal</code>, <code>plant</code>, <code>reptile</code>, or <code>shark_ray</code>.</p></dd>


<dt>scenario</dt>
<dd><p>How to insert a species into the mega-tree?</p><ul><li><p>In both scenarioes, if there is only 1 species in the genus or family, a new node will be inserted to
the middle point of this only species' branch length and the new species will be attached to this new
node.</p></li>
<li><p>If <code>scenario = "at_basal_node"</code>, a species is attached to the basal node of the same genus or the same family
if the mega-tree does not have any species of this genus.</p></li>
<li><p>If <code>scenario = "random_below_basal"</code>, a species is attached to a randomly selected node that is at or below the
basal node of the same genus of the same family if the mega-tree does not have any species in this genus.
The probability of node been selected is proportional to its branch length.
Because of the random sampling involved, you may want to run several times to get a collection of
derived phylogenies.</p></li>
</ul></dd>


<dt>show_grafted</dt>
<dd><p>Whether to indicate which species was grafted onto the mega-tree.
If <code>TRUE</code>, a <code>*</code> will be appended to the species name on the tip if it was grafted within
the same genus; <code>**</code> will be appended if it was grafted within the same family.</p></dd>


<dt>tree_by_user</dt>
<dd><p>Is the mega-tree provided by user? Default is <code>FALSE</code> but it will be automatically set to <code>TRUE</code> when the class of <code>tree</code> is
<code>multiPhylo</code> since we don't provide any such mega-trees here.</p></dd>


<dt>mc_cores</dt>
<dd><p>Number of cores to parallel processing when <code>tree</code> is a list of large number of trees. The default is the number of available cores minus 2.</p></dd>


<dt>.progress</dt>
<dd><p>Form of progress bar, default to be text.</p></dd>


<dt>fish_tree</dt>
<dd><p>Which fish tree do you want to use? If it is "timetree" (default), it will be the smaller time tree with 11638 species
that all have sequence data; if it is "all-taxon", then it will be the 100 larger posterior phylogenies with 31516 soecues.</p></dd>


<dt>mammal_tree</dt>
<dd><p>Which set of mammal trees to use? If it is "vertlife" (default), then 100 randomly selected posterior phylogenies provided
by Vertlife will be used; if it is "phylacine", then 100 randomly selected posterior phylogenies provided by PHYLACINE will be used.</p></dd>


<dt>dt</dt>
<dd><p>Whether to use data.table version to bind tips <a href="bind_tip.html">bind_tip</a>. The default is <code>TRUE</code> as it maybe slightly faster.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A phylogeny for the species required, with class <code>phylo</code>;
or a list of phylogenies with class <code>multiPhylo</code> depends on the input <code>tree</code>. Within each phylogeny, the grafted status of all species was saved as a data frame named as "graft_status".</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Derive a phylogeny from a mega-tree</p>
<p>For a list of species, generate a phylogeny or multiple phylogenies from a
provided mega-tree or mega-trees. If a species is
not in the mega-tree, it will be grafted to the mega-tree with three scenarios.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">test_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Serrasalmus_geryi"</span>, <span class="st">"Careproctus_reinhardti"</span>, <span class="st">"Gobiomorphus_coxii"</span>, </span></span>
<span class="r-in"><span><span class="st">"Periophthalmus_barbarus"</span>, <span class="st">"Prognichthys_glaphyrae"</span>, <span class="st">"Barathronus_bicolor"</span>, </span></span>
<span class="r-in"><span><span class="st">"Knipowitschia_croatica"</span>, <span class="st">"Rhamphochromis_lucius"</span>, <span class="st">"Neolissochilus_tweediei"</span>, </span></span>
<span class="r-in"><span><span class="st">"Haplochromis_nyanzae"</span>, <span class="st">"Astronesthes_micropogon"</span>, <span class="st">"Sanopus_reticulatus"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test_tree</span> <span class="op">=</span> <span class="fu">get_tree</span><span class="op">(</span>sp_list <span class="op">=</span> <span class="va">test_sp</span>,</span></span>
<span class="r-in"><span>                     taxon <span class="op">=</span> <span class="st">"fish"</span>,</span></span>
<span class="r-in"><span>                     show_grafted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 6 species added at genus level (*) </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 species have no co-family species in the mega-tree, skipped</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (if you know their family, prepare and edit species list with `rtrees::sp_list_df()` may help): </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Barathronus_bicolor</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Daijiang Li.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

