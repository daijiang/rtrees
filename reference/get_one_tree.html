<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Derive a phylogeny from a mega-tree — get_one_tree • rtrees</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derive a phylogeny from a mega-tree — get_one_tree"><meta name="description" content="For a list of species, generate a phylogeny from a provided mega-tree. If a species is
not in the mega-tree, it will be grafted to the mega-tree with three scenarioes."><meta property="og:description" content="For a list of species, generate a phylogeny from a provided mega-tree. If a species is
not in the mega-tree, it will be grafted to the mega-tree with three scenarioes."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rtrees</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/grafting_scenarios.html">Grafting Scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/Non-monophyletic-groups.html">Non-monophyletic genera</a></li>
    <li><a class="dropdown-item" href="../articles/Simple_example.html">Simple_example</a></li>
    <li><a class="dropdown-item" href="../articles/speed.html">Speed comparisons</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Derive a phylogeny from a mega-tree</h1>

      <div class="d-none name"><code>get_one_tree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For a list of species, generate a phylogeny from a provided mega-tree. If a species is
not in the mega-tree, it will be grafted to the mega-tree with three scenarioes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_one_tree</span><span class="op">(</span></span>
<span>  <span class="va">sp_list</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  <span class="va">taxon</span>,</span>
<span>  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"at_basal_node"</span>, <span class="st">"random_below_basal"</span><span class="op">)</span>,</span>
<span>  show_grafted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tree_by_user <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .progress <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  dt <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sp-list">sp_list<a class="anchor" aria-label="anchor" href="#arg-sp-list"></a></dt>
<dd><p>A character vector or a data frame with at least three columns: species, genus, family. Species column
holds the species for which we want to have a phylogeny. It can also have two optional columns:
close_sp and close_genus. We can specify the closest species/genus of the species based on
expert knowledge. If specified, the new species will be grafted to that particular location.</p>
<p>It can also be a string vector if <code>taxon</code> is specified. Though it probably is a better idea
to prepare your data frame with <code><a href="sp_list_df.html">sp_list_df()</a></code>. The string vector can also have the same format
as that required by Phylomatic (i.e., family/genus/genus_sp).</p></dd>


<dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>A mega-tree with class <code>phylo</code> or a list of mega-trees with class <code>multiPhylo</code>.
Optional if <code>taxon</code> is specified, in which case, a default
mega-phylogeny (or a set of 100 randomly selected posterior phylogenies) will be used
(see their own documentations from the <code>megatrees</code> package).</p><ul><li><p>For amphibian, the mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_amphibian_n100.html" class="external-link">megatrees::tree_amphibian_n100</a>.</p></li>
<li><p>For bee, the mega-tree is <a href="https://rdrr.io/pkg/megatrees/man/tree_bee.html" class="external-link">megatrees::tree_bee</a>, with <a href="https://rdrr.io/pkg/megatrees/man/tree_bee_n100.html" class="external-link">megatrees::tree_bee_n100</a> be the other option.</p></li>
<li><p>For butterfly, the mega-tee is <a href="https://rdrr.io/pkg/megatrees/man/tree_butterfly.html" class="external-link">megatrees::tree_butterfly</a>.</p></li>
<li><p>For bird, the mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_bird_n100.html" class="external-link">megatrees::tree_bird_n100</a>.</p></li>
<li><p>For fish, the mega-tree is <a href="https://rdrr.io/pkg/megatrees/man/tree_fish_12k.html" class="external-link">megatrees::tree_fish_12k</a>, with <a href="https://rdrr.io/pkg/megatrees/man/tree_fish_32k_n50.html" class="external-link">megatrees::tree_fish_32k_n50</a> be the other option.</p></li>
<li><p>For mammal, the default mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_mammal_n100_vertlife.html" class="external-link">megatrees::tree_mammal_n100_vertlife</a>, with <a href="https://rdrr.io/pkg/megatrees/man/tree_mammal_n100_phylacine.html" class="external-link">megatrees::tree_mammal_n100_phylacine</a> be the other option.</p></li>
<li><p>For plant, the mega-tree is <a href="https://rdrr.io/pkg/megatrees/man/tree_plant_otl.html" class="external-link">megatrees::tree_plant_otl</a>.</p></li>
<li><p>For reptile, the mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_reptile_n100.html" class="external-link">megatrees::tree_reptile_n100</a>.</p></li>
<li><p>For shark, ray, and chimaeras, the mega-trees are <a href="https://rdrr.io/pkg/megatrees/man/tree_shark_ray_n100.html" class="external-link">megatrees::tree_shark_ray_n100</a>.</p></li>
</ul></dd>


<dt id="arg-taxon">taxon<a class="anchor" aria-label="anchor" href="#arg-taxon"></a></dt>
<dd><p>The taxon of species in the <code>sp_list</code>. Currently, can be <code>amphibian</code>, <code>bird</code>, <code>fish</code>, <code>mammal</code>, <code>plant</code>, <code>reptile</code>, or <code>shark_ray</code>.</p></dd>


<dt id="arg-scenario">scenario<a class="anchor" aria-label="anchor" href="#arg-scenario"></a></dt>
<dd><p>How to insert a species into the mega-tree?</p><ul><li><p>In both scenarioes, if there is only 1 species in the genus or family, a new node will be inserted to
the middle point of this only species' branch length and the new species will be attached to this new
node.</p></li>
<li><p>If <code>scenario = "at_basal_node"</code>, a species is attached to the basal node of the same genus or the same family
if the mega-tree does not have any species of this genus.</p></li>
<li><p>If <code>scenario = "random_below_basal"</code>, a species is attached to a randomly selected node that is at or below the
basal node of the same genus of the same family if the mega-tree does not have any species in this genus.
The probability of node been selected is proportional to its branch length.
Because of the random sampling involved, you may want to run several times to get a collection of
derived phylogenies.</p></li>
</ul></dd>


<dt id="arg-show-grafted">show_grafted<a class="anchor" aria-label="anchor" href="#arg-show-grafted"></a></dt>
<dd><p>Whether to indicate which species was grafted onto the mega-tree.
If <code>TRUE</code>, a <code>*</code> will be appended to the species name on the tip if it was grafted within
the same genus; <code>**</code> will be appended if it was grafted within the same family.</p></dd>


<dt id="arg-tree-by-user">tree_by_user<a class="anchor" aria-label="anchor" href="#arg-tree-by-user"></a></dt>
<dd><p>Is the mega-tree provided by user? Default is <code>FALSE</code> but it will be automatically set to <code>TRUE</code> when the class of <code>tree</code> is
<code>multiPhylo</code> since we don't provide any such mega-trees here.</p></dd>


<dt id="arg--progress">.progress<a class="anchor" aria-label="anchor" href="#arg--progress"></a></dt>
<dd><p>Form of progress bar, default to be text.</p></dd>


<dt id="arg-dt">dt<a class="anchor" aria-label="anchor" href="#arg-dt"></a></dt>
<dd><p>Whether to use data.table version to bind tips <a href="bind_tip.html">bind_tip</a>. The default is <code>TRUE</code> as it maybe slightly faster.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A phylogeny for the species required, with class <code>phylo</code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daijiang Li.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

