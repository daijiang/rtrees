<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rtrees">
<title>Non-monophyletic genera • rtrees</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Non-monophyletic genera">
<meta property="og:description" content="rtrees">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rtrees</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Non-monophyletic-groups.html">Non-monophyletic genera</a>
    <a class="dropdown-item" href="../articles/Simple_example.html">Simple_example</a>
    <a class="dropdown-item" href="../articles/grafting_scenarios.html">Grafting Scenarios</a>
    <a class="dropdown-item" href="../articles/speed.html">Speed comparisons</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Non-monophyletic genera</h1>
            
      
      
      <div class="d-none name"><code>Non-monophyletic-groups.Rmd</code></div>
    </div>

    
    
<p>If a species is missing from the megatree and the genus of that
species in the megatree is non-monophyletic, where should we bind it to?
I can think about two options to deal with this. The first is to use the
most inclusive MRCA as what <code>rtrees</code> uses now. The other is
to use the MRCA of the largest cluster of the genus. In my opinion, if a
species is missing it probably means that we know little about that
species; and the safest option is to bind it to the MRCA of all
congeneric species from the megatree.</p>
<p>To compare these two options, I have created a branch on GitHub
(<code>largest_cluster</code>, just a prototype at this moment) to
implement the later option. I then conducted 1,000 simulations. For each
simulation, I randomly sampled 500 species from the 3,000 tips of a
subset tree of megatree <code><a href="https://rdrr.io/pkg/megatrees/man/tree_fish_12k.html" class="external-link">megatrees::tree_fish_12k</a></code>. I used a
smaller subset tree (referred as megatree afterhere) instead of the
megatree itself to save computational time. For phylogenetic diversity
comparisons, these 500 species form a community assemblage. For
phylogenetic signal, I simulated values of a continuous trait of these
500 species following a Browian motion model with sigma of 1. I then
randomly dropped 200 species out of these 500 species from the megatree
(thus we know the ‘true’ phylogeny). I then recreated the phylogeny of
these 500 species by grafting the 200 species back to the megatree using
the two approches to deal with non-monophyletic genera mentioned above.
I then compared the phylogenetic diversity values (Faith’s PD, Mean
Pairwise Distance MPD, and Mean Nearest Taxon Distance MNTD) based on
different scenarios against with the values calculated based on the
‘true’ phylogeny. Phylogenetic signals were estimated using the
<code>phytools::phylosig()</code> function with the method of ‘K’ and
‘lambda’. The simulation codes can be found <a href="https://github.com/daijiang/rtrees_ms/blob/main/Rcode/monophyletic_simulation.R" class="external-link">here</a>.</p>
<p>From the results, we can see that these two approaches give similar
results (both have slopes of ~1 when regressed with ‘true’ values). As
for phylogenetic diversity, what we care is the relative values
comparing with other communities in most cases. Therefore, the slopes,
instead of the absolute differences between estimated values and ‘true’
values (histograms in Fig. 1 A-C), are the most important thing. These
results suggested that the current approach (inclusive) to graft species
to non-monophyletic group works well and there is no significant benefit
gained with the largest cluster approach.</p>
<p>Therefore, I decided to not implement the second option in the main
branch to make it simpler for users.</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/daijiang/rtrees_ms/main/Figs/monophyletic.png" alt="Effects of different approches to graft species to non-monophyletic genera on phylogenetic diversity. Black dashed lines represent 1-to-1 relationships (intercept = 0, slope = 1). These results suggested that the current approach (inclusive) to graft species to non-monophyletic group works well and there is no significant benefit gained with the largest cluster approach." width="100%"><p class="caption">
Effects of different approches to graft species to non-monophyletic
genera on phylogenetic diversity. Black dashed lines represent 1-to-1
relationships (intercept = 0, slope = 1). These results suggested that
the current approach (inclusive) to graft species to non-monophyletic
group works well and there is no significant benefit gained with the
largest cluster approach.
</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daijiang Li.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
